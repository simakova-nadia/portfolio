<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1rem;
      color: #222;
      background-color: #fff;
    }
    h1, h2 {
      border-bottom: 1px solid #eee;
      padding-bottom: 0.3rem;
    }
    ul {
      padding-left: 1.2rem;
    }
    li {
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <h1>–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã</h1>

  <h2>üéØ –¶–µ–ª—å</h2>
  <p>–°–æ–∫—Ä–∞—Ç–∏—Ç—å –æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø–æ–≤—ã—Å–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∑–∞ —Å—á—ë—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–æ—Ä–æ–Ω–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.</p>

  <h2>üìÇ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
  <p>–î–∞–Ω–Ω—ã–µ –æ–±–µ–∑–ª–∏—á–µ–Ω—ã –∏ –≤–∑—è—Ç—ã –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ª–æ–≥–∏–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É.</br>
  <a href="https://archive.ics.uci.edu/dataset/352/online+retail">–°—Å—ã–ª–∫–∞</a></p>
  <p>2011-12-10 ‚Äî —É—Å–ª–æ–≤–Ω–∞—è –¥–∞—Ç–∞ —Å—Ä–µ–∑–∞ (cutoff)</p>
  <img src="../assets/segmentation/initial_data.png" alt="–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ" style="max-width:100%; margin:1rem 0;">

  <h2>üìä –ë–∞–∑–æ–≤—ã–π RFM-–∞–Ω–∞–ª–∏–∑</h2>
<img src="../assets/segmentation/primary_RFM.png" alt="–ë–∞–∑–æ–≤–∞—è RFM-—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è" style="max-width:100%; margin:1rem 0;">
<img src="../assets/segmentation/primary_graphics.png" alt="–ü–µ—Ä–≤–∏—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏" style="max-width:100%; margin:1rem 0;">

  <h2>üßæ SQL-–∑–∞–ø—Ä–æ—Å—ã</h2>
<img src="../assets/segmentation/sql_request.png" alt="SQL-–∑–∞–ø—Ä–æ—Å –∫ –¥–∞–Ω–Ω—ã–º" style="max-width:100%; margin:1rem 0;">
<img src="../assets/segmentation/sql_request_rfm.png" alt="SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è RFM-–∞–Ω–∞–ª–∏–∑–∞" style="max-width:100%; margin:1rem 0;">

  <h2>üßæ SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è RFM-–∞–Ω–∞–ª–∏–∑–∞</h2>
<p><pre style="background:#f4f4f4; padding:1rem; overflow-x:auto; font-size:0.9rem;">
<code class="language-sql">
-- RFM-—Å–∫–æ—Ä–∏–Ω–≥
WITH rfm_data AS (
    SELECT 
        "Customer_ID" as customer_id,
        ('2011-12-10'::date - MAX("Invoice_Date"::date)) as recency,
        COUNT(DISTINCT "Invoice_No") as frequency,
        SUM("Quantity" * "Unit_Price") as monetary
    FROM retail 
    WHERE "Customer_ID" IS NOT NULL 
        AND "Quantity" > 0 
        AND "Unit_Price" > 0
    GROUP BY "Customer_ID"
),
rfm_scores AS (
    SELECT *,        
        CASE 
            WHEN recency <= 30 THEN 5
            WHEN recency <= 90 THEN 4
            WHEN recency <= 180 THEN 3
            WHEN recency <= 365 THEN 2
            ELSE 1
        END as r_score,
        NTILE(5) OVER (ORDER BY frequency) as f_score,
        NTILE(5) OVER (ORDER BY monetary) as m_score
    FROM rfm_data
)
SELECT 
    customer_id,
    recency, frequency, ROUND(monetary, 2) as monetary,
    r_score, f_score, m_score,
    CONCAT(r_score, f_score, m_score) as rfm_segment
FROM rfm_scores
ORDER BY monetary DESC
LIMIT 15;
</code>
</pre>
  </p>

  <h2>üìà RFM –≤ Excel</h2>
<img src="../assets/segmentation/rfm_excel_table.png" alt="RFM-—Ç–∞–±–ª–∏—Ü–∞ –≤ Excel" style="max-width:100%; margin:1rem 0;">
<img src="../assets/segmentation/rfm_excel_sum-table.png" alt="–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ Excel" style="max-width:100%; margin:1rem 0;">
<img src="../assets/segmentation/rfm_excel_graph.png" alt="–ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ Excel" style="max-width:100%; margin:1rem 0;">

  <h2>üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ Power BI</h2>
<img src="../assets/segmentation/rfm_power-bi.png" alt="RFM –≤ Power BI" style="max-width:100%; margin:1rem 0;">
              
  <h2>üîç –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã</h2>
  <ul>
    <li>VIP-–∫–ª–∏–µ–Ω—Ç—ã (12% –±–∞–∑—ã) –ø—Ä–∏–Ω–æ—Å—è—Ç 55% –≤—ã—Ä—É—á–∫–∏</li>
    <li>65% –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ </li>
    <li>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ VIP –≤ 5 —Ä–∞–∑ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ –±–∞–∑–µ</li>
    <li>–õ–æ—è–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É –ø–æ–∫—É–ø–æ–∫</li>
  </ul>

  <h2>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
  <ul>
    <li>–°–Ω–∏–∂–µ–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ 15%</li>
    <li>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏–∑ —Ö–æ–ª–æ–¥–Ω–æ–π –±–∞–∑—ã –≤ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ 4%</li>
    <li>–í—ã—è–≤–ª–µ–Ω–æ 3 –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏</li>
    <li>–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞ —Å—á—ë—Ç —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤</li>
    <li>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ —É–ø—Ä–æ—Å—Ç–∏–ª–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –≤—Å—Ç—Ä–µ—á–∏ —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º</li>
  </ul>

  <h2>üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
  <p>‚Ä¢ Excel ‚Ä¢ SQL ‚Ä¢ Power BI</p>

  <p><a href="../index.html">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
</body>
</html>
